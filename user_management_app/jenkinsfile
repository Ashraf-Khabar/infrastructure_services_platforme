stage('Installation .NET') {
    steps {
        script {
            sh '''
                # Créer un répertoire dans le home sans sudo
                mkdir -p ~/.dotnet
                
                # Télécharger et installer .NET
                curl -sSL https://dot.net/v1/dotnet-install.sh -o dotnet-install.sh
                chmod +x dotnet-install.sh
                ./dotnet-install.sh --channel 8.0 --install-dir ~/.dotnet
                
                # Configurer le PATH
                echo "export DOTNET_ROOT=~/.dotnet" >> ~/.bashrc
                echo "export PATH=\\$PATH:~/.dotnet" >> ~/.bashrc
                export DOTNET_ROOT=~/.dotnet
                export PATH=$PATH:~/.dotnet
                
                # Vérifier
                ~/.dotnet/dotnet --version
            '''
        }
    }
}